{% extends 'samples_manager/base.html' %}
{% block content %}
<script>   
        var starting_sec = function(){
            console.log("getting sec...");
            timestamp = document.getElementById("start_timestamp").value;
            if (timestamp != ''){
                get_sec(); 
            }
            else{
            
            }
        }

        var get_sec = function() {
            var form = $("#sec_form");
            $.ajax({
            url: form.attr("action"),
            data:  form.serialize(),
            type: 'post',
            dataType: 'json',
            success: function (data) {
                    if (data.form_is_valid) {
                        $("#irradiation-table tbody").html(data.html_irradiation_list);  // <-- Replace the table body
                    }
                    else {
                    alert("data is not correct");
                    }
                }
            });
        }
        var nIntervId;
        //nIntervId = setInterval(starting_sec, 5000);
 </script>
 <!-- THE MODAL WE WILL BE USING -->
 <div class="ui modal"  id="modal-irradiation">
    <i class="close icon"></i>
      <div class="scrolling content">
      </div>
</div>
<div class= "ui center aligned raised segment">
    <h2>Irradiation Status</h2>
    <div class= "ui grid segment">
        <div class="three wide column">
                <button type="button" class="ui left floated grey button"  onclick="goBack()" title='Back'>
                            <i class="angle left icon"></i>Back
                </button>
        </div>
        <div class="ten wide column">
            <button type="button"
                        id = "irradiation_new"
                        data-target = "#modal-irradiation"
                        class="ui blue button js-create-sample"
                        title='New irradition'
                        data-url="{% url 'samples_manager:irradiation_new'%}">
                        <i class="plus icon"></i> New Irradiation
            </button>   
        </div>
        <div class="three wide column">
            <form method="post" id="sec_form" action="{% url 'samples_manager:get_sec'%}">
                {% csrf_token %}
                <input type="hidden" id="start_timestamp" name="start_timestamp" value="">
            </form>
        </div>
    </div>
    <div class="sixteen wide column" style='height:750px; overflow-x:scroll; overflow-y:scroll;'>
            <table class="ui center aligned sortable celled table very compact striped" id="irradiation-table">
                <thead>
                    <tr>
                        <th>Updated at</th>
                        <th>Sample</th>
                        <th>Dosimeter</th>
                        <th>Date IN - Date OUT</th>
                        <th>IRRAD<br>table</th>
                        <th>Table<br>position</th>
                        <th>Accumulated<br>fluence</th>
                        <th>SEC</th>
                        <th>Updated by</th>
                        <th>Status</th>
                        <th class="sorttable_nosort">In Beam </th>
                        <th class="sorttable_nosort">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% include 'samples_manager/partial_irradiations_list.html' %}
                </tbody>
            </table>
    </div>
</div>
<script> 
    var in_beam_checkboxes = document.querySelectorAll('.in_beam_checkbox');
        for(var i = 0; i < in_beam_checkboxes.length; i++) {
            console.log(i);
            if(in_beam_checkboxes[i].checked) {
                console.log(in_beam_checkboxes[i]);
            }
        };
        // here to be checked!!
        $('.in_beam_checkbox').checkbox({
                onChecked: () => {
                    alert('is window ? ');
                }
            });
</script>
{% endblock %}



